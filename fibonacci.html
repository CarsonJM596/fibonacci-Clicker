<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fibonacci Clicker</title>
    <style> 
       body {
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f0f0f0;
        }
        #center {
            width: 1200px; 
            height: 500px; 
            text-align: center;
            border-radius: 8px;
            background-color: #fff;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            position: relative;
        }
        #button {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 16px;
            border: none;
            border-radius: 5px;
            background-color: #007bff;
            color: white;
            cursor: pointer;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        #button:hover {
            background-color: #0056b3;
        }
        #num {
            font-size: 2rem;
            margin: 10px 0;
        }
        #count {
            font-size: 1.5rem;
        }
        #factorialToggle{
            position: fixed;
            bottom: 60px;
            left: 50%;
            transform: translateX(-50%);
            padding: 10px 20px;
            font-size: 16px;
            border: none;
            border-radius: 5px;
            background-color: #28a745;
            color: white;
            cursor: pointer;
        }
        #factorialToggle:hover {
            background-color: #218838;
        }
        #controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }
        #resetProgress {
            background-color: #ff4d4d;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            position: fixed;
            bottom: 10px; /* Fixed at bottom of the page */
            left: 50%;
            transform: translateX(-50%);
            transition: background-color 0.3s;
        }
        #resetProgress:hover {
           background-color: #ff1a1a;
        }
    </style>
</head>
<body>
    <div id = "center">
        <h1 id="headerText">Click for Fibonacci!</h1> <!--Header-->
        <h3 id="num"></h3> <!--Used to output fibbonacci sequence number -->
        <p style = "font-size:30px;">Times Clicked:</p> <!--To display how many times clicked-->
        <p id="count"></p> <!--Used to output times clicked-->
        <button id = "button"type="button">Click Here!</button> <!--Button-->
    </div>
    <div id="controls">
        <button id="factorialToggle">Switch to Factorial</button>
        <button id="resetProgress">Reset Progress</button>
    </div>
    <script>
        function setCookie(name, value, hours) { //Set Cookie Method
            const date = new Date();
            date.setTime(date.getTime() + hours * 60 * 60 * 1000);
            const expires = "expires=" + date.toUTCString();
            document.cookie = `${name}=${value}; ${expires}; path=/; SameSite=Lax; Secure`;
        }
    
        function getCookie(name) { //Get Cookie method
            const nameEQ = name + "=";
            const cookies = document.cookie.split(";");
            for (let cookie of cookies) { //Gets cookie 
                cookie = cookie.trim();
                if (cookie.startsWith(nameEQ)) {
                    return cookie.substring(nameEQ.length);
                }
            }
            return null; //Returns null if no cookie 
        }
    
        function fib(n) { //Returns fib value sequence
            if (n <= 1) return n; //Base Case
            let x = 0, y = 1;
            for (let i = 2; i <= n; i++) { //Goes through Fibonacci sequence 
                [x, y] = [y, x + y];
            }
            return y;
        }
    
        function fact(n) { //Returns Factorial Sequence
            if (n<= 1) return 1; //Base case
            let result = 1;
            for (let i = 2; i <= n; i++) { //Goes through Factorial sequence
                result *= i;
            }
            return result;
        }
    
        function getRandomColor() { //Gets a random color 
            const hex = '0123456789ABCDEF';
            let color = '#';
            do { //Creates random color 
                color = '#' + Array.from({ length: 6 }, () => hex[Math.floor(Math.random() * 16)]).join('');
            } while (tooDark(color)); //While it's considered too dark
            return color;
        }
    
        function tooDark(color) {
            const [r, g, b] = [1, 3, 5].map(i => parseInt(color.slice(i, i + 2), 16)); //Grabs red green blue values
            return r + g + b < 50; //Returns if it's too dark
        }
    
        function setRandomColor() { //Sets random color 
            const background = getRandomColor();
            const button = getRandomColor();
            document.getElementById('center').style.backgroundColor = background;
            document.getElementById('button').style.backgroundColor = button;
            setCookie('background', background, 1);
            setCookie('button', button, 1);
        }
    
        function setRandomFontSize() { //Sets random font size
            const countSize = `${Math.random() * 50 + 20}px`;
            const numSize = `${Math.random() * 50 + 20}px`;
            document.getElementById('count').style.fontSize = countSize;
            document.getElementById('num').style.fontSize = numSize;
            setCookie('countFontSize', countSize, 1);
            setCookie('numFontSize', numSize, 1);
        }
    
        function setRandomPosition() { //Sets a random position within center
            const button = document.getElementById('button');
            const box = document.getElementById('center');
            const [randX, randY] = [
                Math.random() * (box.offsetWidth - button.offsetWidth),
                Math.random() * (box.offsetHeight - button.offsetHeight)
            ];
            button.style.left = `${randX}px`;
            button.style.top = `${randY}px`;
            button.style.transform = 'none';
            setCookie('buttonLeft', randX, 1);
            setCookie('buttonTop', randY, 1);
        }
    
        // Initialization
        let mode = getCookie('mode') || 'fibonacci';
        let clickCount = parseInt(getCookie('clickCount')) || 0;
        let displayValue = mode === 'fibonacci' ? fib(clickCount) : fact(clickCount);
    
        document.getElementById('num').innerText = displayValue;
        document.getElementById('count').innerText = clickCount;
    
        // Restore styles from cookies
        const [savedBackground, savedButton, savedCountFont, savedNumFont] = [
            getCookie('background'), getCookie('button'),
            getCookie('countFontSize'), getCookie('numFontSize')
        ];

        //Restores all saved information if saved
        if (savedBackground) document.getElementById('center').style.backgroundColor = savedBackground;
        if (savedButton) document.getElementById('button').style.backgroundColor = savedButton;
        if (savedCountFont) document.getElementById('count').style.fontSize = savedCountFont;
        if (savedNumFont) document.getElementById('num').style.fontSize = savedNumFont;

        //Restores random position if saved
        const [savedLeft, savedTop] = [getCookie('buttonLeft'), getCookie('buttonTop')];
        if (savedLeft && savedTop) {
            const button = document.getElementById('button');
            button.style.left = `${parseFloat(savedLeft)}px`;
            button.style.top = `${parseFloat(savedTop)}px`;
            button.style.transform = 'none';
        }
        //Factorial button
        document.getElementById('factorialToggle').onclick = () => {
            mode = mode === 'fibonacci' ? 'factorial' : 'fibonacci'; // Toggle mode

            // Update the toggle button text
            document.getElementById('factorialToggle').innerText =
                mode === 'fibonacci' ? 'Switch to Factorial' : 'Switch to Fibonacci';

            // Update the header text
            document.getElementById('headerText').innerText =
                mode === 'fibonacci' ? 'Click for Fibonacci!' : 'Click for Factorial!';

            // Update the displayed value
            displayValue = mode === 'fibonacci' ? fib(clickCount) : fact(clickCount);
            document.getElementById('num').innerText = displayValue;

            // Save the mode to a cookie
            setCookie('mode', mode, 1);
        };

    
        document.getElementById('button').onclick = () => {
            if (mode === 'fibonacci') { //Grabs display value 
                displayValue = fib(clickCount);
            } else {
                displayValue = fact(clickCount);
            } 
            clickCount++; //Adds to click count
            document.getElementById('num').innerText = displayValue; //Displays display value 
            document.getElementById('count').innerText = clickCount; //Displays your count 
            //Saves count & displayvalue 
            setCookie('clickCount', clickCount, 1); 
            setCookie('FibValue', displayValue, 1);
            //Sets random
            setRandomColor();
            setRandomFontSize();
            setRandomPosition();
        };

        document.getElementById('resetProgress').onclick = () => {
            // Reset all variables
            clickCount = 0;
            mode = 'fibonacci';
            displayValue = 0;

            // Reset cookies
            document.cookie.split(";").forEach(cookie => {
                const name = cookie.split("=")[0].trim();
                setCookie(name, "", -1); // Set expiration to past time to delete cookie
            });

            // Reset the display
            document.getElementById('num').innerText = displayValue; // Reset number
            document.getElementById('count').innerText = clickCount; // Reset click count
            document.getElementById('factorialToggle').innerText = "Switch to Factorial"; // Reset mode button text

            // Reset styles
            document.getElementById('center').style.backgroundColor = "#ffffff"; // Default background
            document.getElementById('button').style.backgroundColor = "#007bff"; // Default button color
            document.getElementById('count').style.fontSize = "20px"; // Default font size
            document.getElementById('num').style.fontSize = "20px"; // Default font size
            document.getElementById('button').style.left = "50%"; // Default button position
            document.getElementById('button').style.top = "50%";
            document.getElementById('button').style.transform = "translate(-50%, -50%)";

            // Log reset for debugging
            console.log("Progress has been reset!");
        };

    </script>    
</body>
</html> 
